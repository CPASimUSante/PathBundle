{% import 'InnovaPathBundle::Player/components/macros.html.twig' as macros %}


{# Gestion des ressources héritées #}
{% set allParents = currentStep.getParents() %}
{% for parent in allParents %}
	{% for resource in parent.step2ResourceNodes if resource.propagated == true %}
		{# todo - à revoir, y'a surement plus intelligent à faire... mais on est limité par le modèle de données un peu bancal ici #}
		{% set thisResourceIsExcluded = false %}
		{% for resourceCurrentStep in currentStep.step2ResourceNodes if resourceCurrentStep.excluded == true and resourceCurrentStep.resourceNode == resource.resourceNode %}
				{% set thisResourceIsExcluded = true %}
		{% endfor %}
		{% if thisResourceIsExcluded == false and resource.resourceNode.resourceType.name != "icap_dropzone" %}
			{{ macros.displayResource(resource, parent) }}
		{% endif %}
	{% endfor %}
{% endfor %}

{# Gestion des ressources locales #}
{% for resource in currentStep.step2ResourceNodes if resource.excluded == false and resource.resourceNode.resourceType.name != "icap_dropzone" %}
		{{ macros.displayResource(resource, currentStep) }}
{% endfor %}