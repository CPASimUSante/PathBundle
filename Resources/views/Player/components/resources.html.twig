{% import 'InnovaPathBundle::Player/components/macros.html.twig' as macros %}

{# Gestion des ressources héritées #}
{% set allParents = currentStep.getParents() %}
{% for parent in allParents %}
	{% for resource in parent.step2ResourceNodes if resource.propagated == true %}
		{# todo - à revoir, y'a surement plus intelligent à faire... mais on est limité par le modèle de données un peu bancal ici #}
		{% set thisResourceIsExcluded = false %}
		{% for resourceCurrentStep in currentStep.step2ResourceNodes if resourceCurrentStep.excluded == true and resourceCurrentStep.resourceNode == resource.resourceNode %}
				{% set thisResourceIsExcluded = true %}
		{% endfor %}
		{% if thisResourceIsExcluded == false %}
			{{ macros.displayResourcePopup(resource, parent) }}
		{% endif %}
	{% endfor %}
{% endfor %}

{# Gestion des ressources locales #}
{% for resource in currentStep.step2ResourceNodes if resource.excluded == false %}
		{{ macros.displayResourcePopup(resource, currentStep) }}
{% endfor %}

<!--
<div id="popup" style="display:none;z-index:10000; position:fixed; top:20px;bottom:20px; margin:auto;width:80%;padding:10px;border-radius:5px">
</div>
-->

<div id="popup" class="panel panel-default" style="display:none;z-index:10000; position:fixed; top:20px;bottom:20px;left:20px;right:20px; margin:auto;width:90%;padding:10px;border-radius:5px;max-width:1200px" >
	<div class="panel-title">
		<a id="popup-close" class="btn pull-right">Fermer &times;</a>
	</div>
	<iframe id="popup-iframe" width="100%" height="100%" src=""></iframe>
</div>