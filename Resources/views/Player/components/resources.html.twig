{% macro displayResource(resource, step) %}
	<li class="list-group-item"> 

		<span rel="tooltip" data-original-title="{{ step.name }}" class="lvl-{{ step.lvl + 1 }} badge parent-resource">&nbsp;</span>
		{% if resource.resourceNode.resourceType.name == "non_digital_resource" %}
			<a href="#" data-toggle="modal" data-target="#resource-{{ resource.id }}">{{ resource.resourceNode.name }}</a>
			<div class="modal fade" id="resource-{{ resource.id }}">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
							<h4 class="modal-title">{{ resource.resourceNode.name }}</h4>
						</div>
						<div class="modal-body">
							<p>{{ resource.resourceNode.description }}</p>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
						</div>
					</div><!-- /.modal-content -->
				</div><!-- /.modal-dialog -->
			</div><!-- /.modal -->
		{% else %}
		<a target="_blank" href="{{ path('claro_resource_open', {'node': resource.resourceNode.id, 'resourceType': resource.resourceNode.resourceType.name }) }}">{{ resource.resourceNode.name }}</a>
		{% endif %}
	</li>
{% endmacro %}

{% import _self as macros %}

<div class="panel panel-default">
    <div class="panel-heading">
        <h4 class="panel-title">
            <span class="icon-folder-open"></span>
            Ressources
        </h4>
    </div>
    <div class="panel-body">
    	{# Gestion des ressources héritées #}
		{% set allParents = currentStep.getParents() %}
		<ul class="list-group">
		{% for parent in allParents %}
			{% for resource in parent.step2ResourceNodes %}
				{% if resource.propagated == true %}
					{{ macros.displayResource(resource, parent) }}
				{% endif %}
			{% endfor %}
		{% endfor %}

		{# Gestion des ressources locales #}
    	{% set resources = currentStep.step2ResourceNodes %}
    	{% for resource in resources %}
    		{{ macros.displayResource(resource, currentStep) }}
    	{% endfor %}
    	</ul>
    </div>
</div>