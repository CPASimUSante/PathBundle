{% import 'InnovaPathBundle::Player/components/macros.html.twig' as macros %}

{# Affichage des boutons #}

{% set allParents = currentStep.getParents() %}
{% for parent in allParents %}
	{% for resource in parent.step2ResourceNodes if resource.propagated == true %}
		{% set thisResourceIsExcluded = false %}
		{% for resourceCurrentStep in currentStep.step2ResourceNodes if resourceCurrentStep.excluded == true and resourceCurrentStep.resourceNode == resource.resourceNode %}
				{% set thisResourceIsExcluded = true %}
		{% endfor %}
		{% if thisResourceIsExcluded == false %}
			{{ macros.displayResourceButton(resource, parent) }}
		{% endif %}
	{% endfor %}
{% endfor %}

{% for resource in currentStep.step2ResourceNodes if resource.excluded == false %}
		{{ macros.displayResourceButton(resource, currentStep) }}
{% endfor %}

{# Affichage des Frames #}
<div class="panel-group" id="resources-panel-group">
{% set allParents = currentStep.getParents() %}
{% for parent in allParents %}
	{% for resource in parent.step2ResourceNodes if resource.propagated == true %}
		{% set thisResourceIsExcluded = false %}
		{% for resourceCurrentStep in currentStep.step2ResourceNodes if resourceCurrentStep.excluded == true and resourceCurrentStep.resourceNode == resource.resourceNode %}
				{% set thisResourceIsExcluded = true %}
		{% endfor %}
		{% if thisResourceIsExcluded == false %}
			{{ macros.displayResourceFrame(resource, parent) }}
		{% endif %}
	{% endfor %}
{% endfor %}

{% for resource in currentStep.step2ResourceNodes if resource.excluded == false %}
		{{ macros.displayResourceFrame(resource, currentStep) }}
{% endfor %}
</div>